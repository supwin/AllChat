<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facebook Setup Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .prose h3 { margin-top: 1.5em; margin-bottom: 0.5em; font-size: 1.25em; font-weight: 600; }
        .prose p { margin-bottom: 1em; }
        .prose code { background-color: #e5e7eb; padding: 0.2em 0.4em; border-radius: 0.25rem; font-family: monospace; }
        .prose ol { list-style-type: decimal; padding-left: 1.5rem; }
        .prose li { margin-bottom: 0.5em; }
    </style>
</head>
<body class="bg-gray-100">
    <header class="bg-white shadow-sm">
        <div class="max-w-4xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
            <a href="#" id="back-to-dashboard" class="text-sm text-blue-600 hover:underline">&larr; กลับไปหน้าหลัก</a>
            <h1 class="text-2xl font-bold text-gray-900 mt-1">คู่มือการเชื่อมต่อกับ Facebook Messenger</h1>
        </div>
    </header>

    <main class="max-w-4xl mx-auto py-6 sm:px-6 lg:px-8">
        <div class="bg-white p-8 rounded-lg shadow prose">
            <h3>ภาพรวมการตั้งค่า</h3>
            <p>การเชื่อมต่อบอทของคุณกับ Facebook Page ต้องมีการตั้งค่าที่ <a href="https://developers.facebook.com/" target="_blank" class="text-blue-600">Facebook for Developers</a> เพื่อให้ Facebook รู้จักบอทของเรา และเพื่อให้บอทของเรามีสิทธิ์ในการตอบกลับข้อความในนามของเพจครับ</p>

            <h3>วิดีโอสอนการตั้งค่า (ตัวอย่าง)</h3>
            <div class="aspect-w-16 aspect-h-9">
                <!-- นี่คือวิดีโอตัวอย่าง คุณสามารถเปลี่ยนเป็นวิดีโอของคุณเองได้ -->
                <iframe src="https://www.youtube.com/embed/S1u_8Lg9x3g" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>

            <h3>ขั้นตอนที่ 1: การสร้างแอปและหา Tokens</h3>
            <p>เราต้องการข้อมูลสำคัญ 2 อย่างจาก Facebook คือ Page Access Token และ Verify Token ที่คุณต้องตั้งขึ้นเอง</p>
            <ol>
                <li>ไปที่ <a href="https://developers.facebook.com/apps/" target="_blank" class="text-blue-600">Facebook for Developers</a> แล้วคลิก <strong>"สร้างแอป" (Create App)</strong></li>
                <li>เลือกประเภทแอปเป็น <strong>"ธุรกิจ" (Business)</strong> แล้วทำตามขั้นตอนจนสร้างแอปสำเร็จ</li>
                <li>ในหน้า Dashboard ของแอป ให้มองหา "Messenger" แล้วคลิก <strong>"ตั้งค่า" (Set up)</strong></li>
                <li>ในส่วน "Access Tokens" ให้คลิก <strong>"Add or Remove Pages"</strong> เพื่อเลือกเพจที่คุณต้องการเชื่อมต่อ</li>
                <li>หลังจากเลือกเพจแล้ว ให้กดปุ่ม <strong>"Generate Token"</strong> เพื่อสร้าง <strong>Page Access Token</strong> คัดลอก Token นี้เก็บไว้</li>
                <li>สำหรับ <strong>Verify Token</strong> ให้คุณ "คิดรหัสผ่านลับ" ขึ้นมาเอง (เช่น <code>MySecretBot2025</code>) แล้วจดไว้</li>
                <li>นำค่าทั้งสองนี้ไปวางในช่อง <code>Facebook Page Access Token</code> และ <code>Facebook Verify Token</code> ใน <a href="#" id="link-to-settings" class="text-blue-600">หน้าตั้งค่าบอท</a> ของคุณ</li>
            </ol>

            <h3>ขั้นตอนที่ 2: การตั้งค่า Webhook</h3>
            <p>ขั้นตอนนี้คือการบอก Facebook ว่าถ้ามีคนส่งข้อความมาที่เพจ ให้ส่งข้อมูลนั้นมาที่ "ที่อยู่" ของบอทเรา</p>
             <ol>
                <li>ในหน้าตั้งค่า Messenger เดียวกัน ให้เลื่อนลงมาที่ส่วน "Webhooks"</li>
                <li>คลิก <strong>"Add Callback URL"</strong></li>
                <li>คัดลอก **Webhook URL สำหรับ Facebook** จาก <a href="#" id="link-to-settings-2" class="text-blue-600">หน้าตั้งค่าบอท</a> ของคุณ (URL จะมีลักษณะเป็น <code>.../webhook/facebook/...</code>)</li>
                <li>นำ URL ที่คัดลอกมาไปวางในช่อง <strong>"URL การเรียกกลับ" (Callback URL)</strong></li>
                <li>นำ <strong>Verify Token</strong> ที่คุณตั้งขึ้นเองในขั้นตอนที่แล้ว มาใส่ในช่อง <strong>"โทเค็นการตรวจสอบยืนยัน" (Verify Token)</strong></li>
                <li>กดปุ่ม <strong>"ตรวจสอบยืนยันและบันทึก"</strong></li>
                <li>หลังจากบันทึกสำเร็จ ให้คลิก <strong>"เพิ่มการสมัครรับข้อมูล" (Add subscriptions)</strong> สำหรับเพจของคุณ แล้วติ๊กเลือก <strong><code>messages</code></strong> และ <strong><code>messaging_postbacks</code></strong></li>
            </ol>
            <p>เพียงเท่านี้ บอทของคุณก็พร้อมที่จะทำงานบน Facebook Messenger แล้วครับ!</p>
        </div>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const TENANT_ID = urlParams.get('tenant_id');
            if(TENANT_ID) {
                document.getElementById('back-to-dashboard').href = `/dashboard?tenant_id=${TENANT_ID}`;
                document.getElementById('link-to-settings').href = `/settings?tenant_id=${TENANT_ID}`;
                document.getElementById('link-to-settings-2').href = `/settings?tenant_id=${TENANT_ID}`;
            }
        });
    </script>
</body>
</html>
